在上一篇笔记中，我们引入了Probabilitics inference的概念，并且介绍了直接通过枚举的方法进行推断。但是这种方法的问题在于会占据大量内存。于是，我们将介绍贝叶斯网络来解决这个问题。其基本想法是使用一个有向无环图（directed acyclic graph）来描述变量之间的关系，接下来我们将详细介绍

# Structure of Bayesian Network


贝叶斯网络是一个有向无环图，每个结点都对应一个随机变量。从大的角度看，结点之间的连接方式告诉我们它们之间相互依赖的关系；从单个结点的角度看，每个结点存储着一个**conditional probability table**，值得我们能够定量计算条件概率（但是怎么计算呢？）

贝叶斯网络有下面两个性质：

1. 一个结点的父节点已知（或者“被观测”），则它与**祖先结点**条件独立。
2. 一个结点的**马尔科夫毯**已知（被观测），则它与其他任何结点都是条件独立的

在贝叶斯网络中，上面提到的马尔可夫毯包括这个结点的父母、子女、配偶。

基于上面两条性质，我们可以计算概率了。

$$P(X_1, \cdots, X_n) = \prod_{i = 1}^n P (X_i | parents(X_i))$$

上式的成立其实是平凡的，因为我们可以将一个联合概率展开成条件概率的形式，而上面提到的性质1使得我们只需要考虑每个结点的父母，而不需要考虑它们的祖先。

# D-Separation

贝叶斯网络的拓朴结构反映了随机变量之间的独立性和条件独立性。

这篇博客讲得也很不错：[贝叶斯网络模型的例子详解](https://blog.csdn.net/qq_41603411/article/details/104708470)

![[BayesNetwork.excalidraw]]

上图表示了三种基本的拓扑结构，接下来我们介绍D-Separation的方法，来在已有观测的基础上，判断两个结点之间是否相关。具体来说，如果我们已经有了$\{Z_1, Z_2, \cdots, Z_n\}$的观测结果，想知道$X$与$Y$是否相互独立，也就是想判断是否有$X\perp \! \! \! \perp Y | \{Z_1, Z_2, \cdots, Z_n\}$，可以使用如下的方法：

1. 在贝叶斯网络中标记所有观测到的结点
2. 得到所有连接$X$和$Y$的无向路径
3. 对于每条路径：
	1. 


